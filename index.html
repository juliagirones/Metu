<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Metu</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #f5f5dc; /* beige suave */
    }
    canvas {
      display: block;
    }
    .controls {
      position: absolute;
      bottom: 20px;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 30px;
    }
    .btn {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      font-size: 16px;
      border: none;
    }
    .start-screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(245, 245, 220, 0.9);
      font-size: 48px;
      font-weight: bold;
      color: black;
      z-index: 10;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>
  <div class="controls">
    <button class="btn" id="duckBtn">⬇</button>
    <button class="btn" id="jumpBtn">⬆</button>
  </div>
  <div class="start-screen" id="startScreen">3</div>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;const jumpBtn = document.getElementById("jumpBtn");
const duckBtn = document.getElementById("duckBtn");

let player = {
  x: 100,
  y: canvas.height - 150,
  width: 50,
  height: 50,
  dy: 0,
  gravity: 1.5,
  jumping: false,
  ducking: false
};

let ground = canvas.height - 100;

let obstacles = [];
let candies = [];
let frame = 0;
let levelDuration = 60 * 60; // 1 minuto a 60fps

function drawPlayer() {
  ctx.beginPath();
  ctx.rect(player.x, player.y, player.width, player.height);
  ctx.strokeStyle = "black";
  ctx.lineWidth = 3;
  ctx.stroke();
}

function drawObstacle(ob) {
  ctx.beginPath();
  ctx.rect(ob.x, ob.y, ob.width, ob.height);
  ctx.strokeStyle = "black";
  ctx.stroke();
}

function drawCandy(c) {
  ctx.beginPath();
  ctx.arc(c.x, c.y, c.r, 0, Math.PI * 2);
  ctx.strokeStyle = "black";
  ctx.stroke();
}

function drawMermaidTail() {
  ctx.beginPath();
  ctx.moveTo(canvas.width - 100, ground);
  ctx.lineTo(canvas.width - 80, ground - 40);
  ctx.lineTo(canvas.width - 60, ground);
  ctx.moveTo(canvas.width - 80, ground - 40);
  ctx.lineTo(canvas.width - 100, ground - 60);
  ctx.moveTo(canvas.width - 80, ground - 40);
  ctx.lineTo(canvas.width - 60, ground - 60);
  ctx.strokeStyle = "black";
  ctx.stroke();
}

function update() {
  frame++;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Movimiento
  if (player.jumping) {
    player.dy -= player.gravity;
    player.y -= player.dy;
    if (player.y >= ground - player.height) {
      player.y = ground - player.height;
      player.jumping = false;
      player.dy = 0;
    }
  }

  if (player.ducking) {
    player.height = 30;
  } else {
    player.height = 50;
  }

  drawPlayer();

  // Obstáculos y dulces
  if (frame % 100 === 0) {
    if (Math.random() > 0.5) {
      // salto
      obstacles.push({ x: canvas.width, y: ground - 50, width: 30, height: 50 });
    } else {
      // agacharse
      obstacles.push({ x: canvas.width, y: ground - 100, width: 30, height: 30 });
    }
    candies.push({ x: canvas.width + 100, y: ground - 150, r: 10 });
  }

  obstacles.forEach((ob, i) => {
    ob.x -= 5;
    drawObstacle(ob);
    if (ob.x + ob.width < 0) obstacles.splice(i, 1);
  });

  candies.forEach((c, i) => {
    c.x -= 5;
    drawCandy(c);
    if (c.x + c.r < 0) candies.splice(i, 1);
  });

  if (frame >= levelDuration) drawMermaidTail();

  requestAnimationFrame(update);
}

jumpBtn.addEventListener("click", () => {
  if (!player.jumping) {
    player.jumping = true;
    player.dy = 20;
  }
});

duckBtn.addEventListener("mousedown", () => player.ducking = true);
duckBtn.addEventListener("mouseup", () => player.ducking = false);

// Countdown
let countdown = 3;
const startScreen = document.getElementById("startScreen");
const interval = setInterval(() => {
  if (countdown > 1) {
    countdown--;
    startScreen.innerText = countdown;
  } else {
    clearInterval(interval);
    startScreen.innerText = "HALLOWEEN!";
    setTimeout(() => {
      startScreen.style.display = "none";
      update();
    }, 1000);
  }
}, 1000);

  </script>
</body>
</html>
